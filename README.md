# Сервис сокращения URL

Простой сервис на Java для сокращения длинных ссылок с дополнительными функциями, такими как отслеживание использования, срок действия ссылок и управление доступом по пользователям.

---
Процесс создания сервиса
Сервис сокращения ссылок был разработан с использованием языка программирования Java и менеджера сборки Maven. Основная задача проекта — преобразование длинных URL в короткие, отслеживание переходов по сокращённым ссылкам, а также удаление ссылок с истёкшим сроком действия.

Ключевые этапы разработки:
1.	Анализ требований:
o	Генерация уникальных коротких ссылок.
o	Учет переходов по ссылке и контроль лимита.
o	Удаление ссылок с истёкшим сроком действия.
o	Работа с пользователем через консоль.
2.	Реализация:
o	Использован Java-класс UrlShortenerService для обработки логики сокращения URL.
o	Для хранения информации о ссылках использованы структуры данных (например, HashMap).
o	Интеграция с браузером для перехода по сокращённым ссылкам с использованием Desktop.getDesktop().browse().
3.	Тестирование:
o	Проверка корректной генерации уникальных ссылок для каждого пользователя.
o	Тестирование ограничения количества переходов.
o	Проверка автоматического удаления ссылок после истечения их срока действия.

2. Описание сервиса
Сервис состоит из следующих функциональных модулей:
•	Генерация коротких ссылок:
o	Пользователь вводит длинный URL, система генерирует уникальный короткий URL, связанный с идентификатором пользователя.
•	Переход по ссылкам:
o	Введя короткую ссылку, пользователь автоматически перенаправляется на исходный сайт через браузер.
•	Лимит переходов:
o	Система фиксирует количество переходов по каждой ссылке. При превышении лимита ссылка становится недоступной.
•	Срок действия ссылок:
o	Каждая ссылка имеет время жизни (например, сутки). По истечении этого времени ссылка удаляется.

**Как пользоваться сервисом**

Инструкция для пользователя
Установка и запуск

1.	Установите JDK 8  или выше, Git Bash: Убедитесь, что Java, Git Bash установлены на вашем компьютере, выполнив команду:
Bash - java -version

2.	Установите Maven: Проверьте наличие Maven:
Bash - mvn -v

3.	Клонируйте проект из GitHub:
Bash - git clone <URL вашего репозитория>
cd <папка проекта>

4.	Соберите проект с помощью Maven:
Bash - mvn clean install

5.	Запустите проект:
Bash - mvn exec:java -Dexec.mainClass=org.example.Main

Использование сервиса
1.	Сокращение ссылки:
o	После запуска введите длинный URL (например, https://example.com).
o	Сервис сгенерирует короткую ссылку и выведет её на экран.
2.	Переход по ссылке:
o	Введите сгенерированную короткую ссылку.
o	Откроется браузер, перенаправив вас на исходный сайт.
3.	Обработка лимита переходов:
o	Если лимит переходов по ссылке превышен, система уведомит вас о недоступности ссылки.
4.	Удаление по истечении срока:
o	Система автоматически удаляет ссылки после истечения их срока действия (например, через сутки).


**Срок действия и лимиты**
Ссылки истекают через 24 часа или после заданного количества переходов (например, 5). 
Если срок действия истёк или лимит достигнут, программа уведомит об этом.


**Поддерживаемые команды**
Сокращение ссылки
Введите длинный URL, чтобы получить сокращённую версию.


**Переход по сокращенной ссылке**
Введите сокращённую ссылку, чтобы открыть оригинальный URL в вашем браузере.


**Отслеживание переходов**
Сервис ведёт учёт количества переходов по каждой ссылке. Когда лимит достигнут, ссылка становится недоступной.


**Как протестировать код**

**Запуск приложения**
Клонируйте репозиторий:
git clone <repository-url>

**Перейдите в папку проекта:**
cd <project-directory>

**Соберите проект:**
mvn clean install

**Запустите программу:**
mvn exec:java -Dexec.mainClass=org.example.Main


Описание файла pom.xml для проекта
Файл pom.xml — это основной файл конфигурации для проекта, который управляется с помощью Apache Maven. Он определяет структуру проекта, зависимости, плагины и другие настройки, необходимые для сборки и запуска приложения.
Основные элементы файла pom.xml
1.	Основная информация о проекте
<groupId>org.example</groupId>
<artifactId>url-shortener</artifactId>
<version>1.0-SNAPSHOT</version>
<packaging>jar</packaging>
o	groupId — уникальный идентификатор группы (обычно это доменное имя организации в обратном порядке).
o	artifactId — имя артефакта (проекта).
o	version — текущая версия проекта.
o	packaging — тип создаваемого файла (в данном случае .jar).
2.	Свойства проекта
<properties>
    <maven.compiler.source>1.8</maven.compiler.source>
    <maven.compiler.target>1.8</maven.compiler.target>
</properties>
Указывает версию Java, которая будет использоваться для компиляции проекта (1.8 в данном случае).
3.	Зависимости
Раздел <dependencies> содержит список библиотек и модулей, которые проект использует. Если требуются дополнительные библиотеки, они указываются здесь.



4.	Плагины для сборки
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>3.8.1</version>
            <configuration>
                <source>${maven.compiler.source}</source>
                <target>${maven.compiler.target}</target>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>exec-maven-plugin</artifactId>
            <version>3.5.0</version>
            <configuration>
                <mainClass>org.example.Main</mainClass>
            </configuration>
        </plugin>
    </plugins>
</build>
o	maven-compiler-plugin
Используется для компиляции Java-кода, указывает версию Java.
o	exec-maven-plugin
Позволяет запускать Java-программы с помощью Maven. В параметре <mainClass> указан основной класс с методом main.
Как работает pom.xml в этом проекте
1.	Компилирует проект с помощью maven-compiler-plugin на версии Java 1.8.
2.	Позволяет запускать приложение напрямую через команду: 
3.	mvn exec:java -Dexec.mainClass=org.example.Main
4.	Упрощает управление зависимостями и позволяет легко добавлять новые библиотеки в проект.
Этот файл — ключ к управлению сборкой, зависимостями и запуском проекта с помощью Maven.


Описание класса Main для проекта
Класс Main в этом проекте выполняет функцию точки входа и реализации работы с сервисом сокращения URL. Этот класс предоставляет функционал для генерации короткой ссылки на основе длинного URL, а также для перехода по сокращенной ссылке с использованием Desktop API для открытия браузера.

Основные функции класса Main:
Генерация уникального идентификатора пользователя (UUID):
В начале работы программы создается уникальный идентификатор для каждого пользователя, что позволяет связать его с созданной ссылкой. Это помогает индивидуализировать работу с сокращенными URL для каждого пользователя.

UUID userId = UUID.randomUUID();
Ввод длинной ссылки для сокращения:
Пользователь вводит длинную ссылку в консоль, и программа передает эту ссылку в сервис для генерации короткой версии. Этот шаг запрашивает от пользователя URL.

System.out.print("Enter URL to shorten: ");
String longUrl = scanner.nextLine();
Генерация сокращенной ссылки:
С помощью метода generateShortUrl из UrlShortenerService программа генерирует короткую ссылку. Эта ссылка содержит как идентификатор пользователя, так и зашифрованную оригинальную ссылку, что позволяет сгенерировать уникальную ссылку для каждого пользователя.

String shortUrl = service.generateShortUrl(longUrl, userId);
System.out.println("Shortened URL: " + shortUrl);
Ввод сокращенной ссылки для перехода:
После генерации короткой ссылки, пользователю предлагается ввести сокращенную ссылку, по которой он хочет перейти. Программа ожидает ввода сокращенной ссылки и затем производит переход по ней.

System.out.print("Enter shortened URL to visit: ");
String userShortUrl = scanner.nextLine();
Добавление префикса в случае необходимости:
Если пользователь введет сокращенную ссылку без префикса http://short.url/, программа автоматически добавляет его, чтобы привести URL к правильному формату для перехода.

if (!userShortUrl.startsWith("http://short.url/")) {
    userShortUrl = "http://short.url/" + userShortUrl;
}
Метод openInBrowser:
Этот метод проверяет, поддерживает ли система работу с Desktop API. Если поддержка имеется, он открывает браузер с оригинальным URL. Программа разворачивает короткую ссылку в длинный URL, используя метод getOriginalUrl из UrlShortenerService, а затем открывает полученный URL в браузере.

public static void openInBrowser(String shortUrl, UrlShortenerService service) {
    try {
        
        String longUrl = service.getOriginalUrl(shortUrl);

        
        if (longUrl != null) {
            
            URI uri = new URI(longUrl);

            
            if (Desktop.isDesktopSupported()) {
                Desktop desktop = Desktop.getDesktop();
                desktop.browse(uri);  // Открытие браузера с заданной ссылкой
            } else {
                System.out.println("Desktop is not supported on this system.");
            }
        } else {
            System.out.println("Error: Short URL not found.");
        }
    } catch (IOException | URISyntaxException e) {
        System.out.println("Error opening URL in browser: " + e.getMessage());
    }
}


Описание класса UrlShortenerService
Класс UrlShortenerService предоставляет логику для работы с сервисом сокращения URL. Он включает в себя методы для генерации сокращенных ссылок, сохранения их в "базу данных" (в данном случае, использующую структуру данных Map) и восстановления оригинальных URL из сокращенных ссылок.

Основные функции класса UrlShortenerService:
Хранение данных: Внутри класса используется коллекция Map<String, String>, которая имитирует базу данных, где ключом является уникальная часть короткой ссылки, а значением — оригинальная длинная ссылка. Эта коллекция обеспечивает возможность быстрого поиска и восстановления оригинальных URL по сокращенным ссылкам.

private Map<String, String> urlDatabase = new HashMap<>();
Метод generateShortUrl: Этот метод отвечает за создание короткой ссылки. Он принимает длинную ссылку и UUID пользователя, генерирует уникальный идентификатор для этой ссылки, кодирует длинный URL в строку Base64 и формирует короткую ссылку. Полученная короткая ссылка сохраняется в "базе данных" для последующего использования.

Процесс генерации URL:
В начале метода создается уникальная строка для каждого пользователя, которая включает UUID и кодированную длинную ссылку. Эта строка добавляется к базовому URL http://short.url/, что создает уникальную сокращенную ссылку.
public String generateShortUrl(String longUrl, UUID userId) {
    String shortUrlPart = userId.toString() + "/" + encodeBase64(longUrl);
    String shortUrl = "http://short.url/" + shortUrlPart;

    urlDatabase.put(shortUrlPart, longUrl);
    return shortUrl;
}
Метод encodeBase64:
Для кодирования длинной ссылки используется стандартный метод Base64.getUrlEncoder(). Это позволяет получить безопасную для URL строку, которая может быть использована в короткой ссылке.
private String encodeBase64(String longUrl) {
    return Base64.getUrlEncoder().encodeToString(longUrl.getBytes());
}
Метод getOriginalUrl: Этот метод используется для извлечения оригинальной длинной ссылки, если пользователю нужно вернуться к ней. Он принимает сокращенную ссылку, извлекает уникальную часть (без префикса http://short.url/) и ищет соответствующий оригинальный URL в базе данных.

public String getOriginalUrl(String shortUrl) {
    String shortUrlPart = shortUrl.replace("http://short.url/", "");
    return urlDatabase.get(shortUrlPart);
}
